<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Auth Test</title>
    <!-- 1. Include the official Telegram script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            background-color: #222;
            color: white;
        }

        #status {
            color: yellow;
        }

        #data {
            color: lightgreen;
            word-wrap: break-word;
        }
    </style>
</head>

<body>
    <h1>Telegram Authentication Test</h1>
    <p>Status: <b id="status">Initializing...</b></p>
    <hr>
    <p>Received initData:</p>
    <pre id="data">Waiting for data...</pre>

    <script>
        try {
            const tg = window.Telegram.WebApp;

            // Let Telegram know we are ready
            tg.ready();

            const statusEl = document.getElementById('status');
            const dataEl = document.getElementById('data');

            // Get the initData string
            const initData = tg.initData;

            if (initData) {
                statusEl.textContent = "SUCCESS!";
                statusEl.style.color = "lightgreen";
                dataEl.textContent = initData;
                console.log("SUCCESS: initData from Telegram:", initData);
            } else {
                statusEl.textContent = "FAILED: initData is empty or missing.";
                statusEl.style.color = "red";
                console.error("FAILED: initData is empty or missing.");
            }

        } catch (error) {
            document.getElementById('status').textContent = "CRITICAL ERROR: Telegram script likely failed to load.";
            document.getElementById('status').style.color = "red";
            console.error("CRITICAL SCRIPT ERROR:", error);
        }
    </script>
</body>

</html>